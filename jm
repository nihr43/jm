#!/bin/sh

set -e

ACTION=$1
JAIL_NAME=$2
JM_DIR=`cat ./.jm.config | grep JM_PATH | awk -F '=' '{print $2}'`

if [ ! -e /etc/jail.conf ]; then
        cp ./.jail.conf.template /etc/jail.conf
	echo 'path = "'$JM_DIR'/$name";' >> /etc/jail.conf
fi


case $ACTION in
	create)
		./lib/create_jail.sh $JM_DIR $JAIL_NAME
		;;
	delete)
		./lib/delete_jail.sh $JM_DIR $JAIL_NAME
		;;
	list)
		./lib/list_jail.sh $JM_DIR | column -t
		;;
	start)
		./lib/start_jail.sh $JAIL_NAME
		;;
	stop)
		./lib/stop_jail.sh $JAIL_NAME
		;;
	restart)
                ./lib/restart_jail.sh $JAIL_NAME
                ;;
	*)
		echo "invalid action"
		;;
esac

